#### 至2025年2月6日已经完成开发工作的总结摘要

下面是一份严格符合 Markdown 语法的结构化总结摘要，包含了项目“近视预防干预系统”从最初的开发任务完成情况记录（250203 与 250204）到今天完成的工作内容、技术细节、已确认的源代码、系统架构信息以及各模块完成情况的完整总结。你可以将此文档作为后续开发工作的上下文参考。

------

# 近视预防干预系统 项目总结摘要

## 一、项目背景与目标

本项目旨在构建一套覆盖学生视力筛查、干预跟踪、统计分析及图文报表输出的“近视预防干预系统”。系统主要功能包括：

- **数据采集与录入**：支持 Excel 批量导入和单条录入，自动校验必填字段及数据格式（例如视力值范围、电话号码正则校验等）。
- **数据存储与管理**：使用 SQLAlchemy 定义 ORM 模型，支持数据的动态聚合与分析。
- **统计分析**：实现近视程度分类、干预效果评估、趋势预测等统计功能。
- **前端展示**：提供 Web 端数据维护、查询、统计分析和大屏展示；同时支持微信小程序端部分功能。
- **权限管理**：基于用户角色（家长、校医、医生、区域管理员、系统管理员）进行权限控制。

------

## 二、项目目录结构及开发环境

### 2.1 目录结构（部分关键目录）

```
VISION_HEALTH_SYSTEM/
├── .chat/
├── config/
│   ├── app/
│   │   └── config.py
│   └── security_rules/
├── docker/
├── docs/
│   ├── 20250205开发计划.md
│   ├── 近视预防干预系统开发文档_v1.0.md
│   ├── 近视预防干预系统开发文档_v1.1.md
│   ├── 近视预防干预系统需求文档_v1.0.md
│   ├── 近视预防干预系统需求文档_v1.1.md
│   ├── 开发任务完成情况记录-250203.md
│   ├── 开发任务完全情况记录-250204.md
│   └── … (其他文档)
├── frontend/
│   ├── vscode-extension/
│   └── web/
│       ├── data_entry.html
│       ├── data_query.html
│       └── query_statistics.html (或 dashboard.html)
├── instance/
│   └── app.db
├── scripts/
├── src/
│   ├── context_system/
│   │   ├── api/
│   │   │   ├── endpoints/
│   │   │   │   ├── student_api.py
│   │   │   │   ├── query_api.py
│   │   │   │   └── import_api.py (部分调试中)
│   │   │   └── __init__.py
│   │   ├── core/
│   │   │   ├── managers/
│   │   │   ├── models/
│   │   │   │   ├── student.py
│   │   │   │   └── __init__.py
│   │   │   ├── services/
│   │   │   └── tasks/
│   │   └── __init__.py
│   └── __init__.py
├── tests/
│   ├── e2e/
│   ├── integration/
│   └── unit/
│       ├── test_student_api.py
│       ├── test_query_api.py
│       └── test_import_api.py
├── app.py
├── init_db.py
├── README.md
└── requirements.txt
```

### 2.2 开发环境

- **操作系统**：Windows
- **开发工具**：VSCode（集成 PowerShell 终端）、Git（版本管理）、GitHub（代码托管）
- **Python 版本**：已安装 Python 3.10.10 和 Python 3.12.8（使用 pyenv 管理多版本）
- **虚拟环境**：项目根目录下创建了 `.venv` 虚拟环境
- **依赖库**：Flask、SQLAlchemy、Pandas、Flask-Migrate（可选）、Chart.js、Bootstrap、Font Awesome 等
- **数据库**：初期使用 SQLite（数据库文件存放在 `instance/app.db` 中），后续可迁移至 MySQL

------

## 三、开发任务完成情况记录

### 3.1 《开发任务完成情况记录-250203》

#### 3.1.1 项目初始化

- 在 `E:\DEV_CONTEXT\1_Projects\VISION_HEALTH_SYSTEM` 下创建项目根目录
- 创建子目录：
  - `E:\DEV_CONTEXT\0_Global`（全局配置与共享资源）
  - `E:\DEV_CONTEXT\2_Runtime`（运行时文件和日志）

#### 3.1.2 开发环境配置

- **安装 Python**：在指定目录安装了 Python 3.10.10 和 3.12.8
- **安装 VSCode**：使用 VSCode 和 VSCode Insiders
- **配置 pyenv**：使用 pyenv-win 管理多个 Python 版本

#### 3.1.3 开发环境设置

- 创建虚拟环境 `.venv`
- 安装依赖库
- 配置 VSCode 的 Python 解释器为 Python 3.10.10

#### 3.1.4 应用运行

- 启动 Flask 开发服务器（运行 `app.py` 后显示 “Hello, Flask!”）
- 验证基本页面在 `http://127.0.0.1:5000/` 正常显示

#### 3.1.5 单元测试

- 编写基础单元测试（例如 `tests/test_app.py` 和 `tests/unit/test_student_api.py`）

- 运行测试命令：

  ```powershell
  python -m unittest tests/test_app.py
  ```

- 解决了 Werkzeug 版本兼容问题

------

### 3.2 《开发任务完成情况记录-250204》

#### 3.2.1 项目目录结构与环境配置

- 项目根目录为 `E:\DEV_CONTEXT\1_Projects\VISION_HEALTH_SYSTEM`
- 后端代码存放在 `src/context_system/`，前端页面存放在 `frontend/web/`
- 配置文件位于 `config/app/config.py`
- 数据库使用 SQLite（存放于 `instance/app.db`）

#### 3.2.2 配置文件与应用初始化

- 配置文件（`config/app/config.py`）正确设置 `SQLALCHEMY_DATABASE_URI`
- 修改 `app.py`，使用 `from_object` 加载配置文件，并初始化数据库和注册 API 蓝图（如 `student_api` 和 `query_api`）

#### 3.2.3 数据库初始化

- 编写 `init_db.py` 脚本，通过 `db.create_all()` 创建数据库和表结构

#### 3.2.4 后端 API 开发

- **单条数据录入 API**：在 `src/context_system/api/endpoints/student_api.py` 中实现 `/api/student/add`
  - 接收 JSON 数据、验证必填字段（例如教育ID号、姓名、学校代码、左眼视力、右眼视力），并存入数据库
  - 出现错误时进行回滚，并返回错误信息
- **数据查询 API**：在 `src/context_system/api/endpoints/query_api.py` 中实现 `/api/students/query`
  - 支持按姓名模糊查询及分页返回 JSON 数据

#### 3.2.5 前端页面实现

- 数据录入页面

  ：

  ```
  frontend/web/data_entry.html
  ```

  - 基于 Bootstrap 表单和 jQuery AJAX 实现数据录入

- 数据查询页面

  ：

  ```
  frontend/web/data_query.html
  ```

  - 基于 Bootstrap 表单和 jQuery AJAX 实现数据查询及分页显示

#### 3.2.6 单元测试

- 编写并运行了针对 API 的单元测试，所有测试均通过

------

## 四、今天完成的工作

### 4.1 Dashboard / 综合查询与统计分析页面开发

针对菜单功能和查询组合区域提出以下要求：

1. **左侧菜单**
    左侧菜单从上到下依次为：
   - 首页
   - 基本信息
   - 学校数量
   - 班级数量
   - 学生数量
   - 视力数据
   - 干预效果
   - 干预次数
2. **顶部查询区域**
    根据左侧菜单不同项，顶部区域动态显示对应的查询组合菜单：
   - **首页**：显示基本统计信息（学校数量、学生数量、性别比例、近视程度占比、干预效果、视力改善人数及比例等）。
   - **基本信息**：显示下拉查询组合菜单，查询类别包括“学校”、“年级”、“班级”、“姓名”、“性别”，支持“全选”及模糊搜索（本示例中使用静态模拟数据）。
   - **其它菜单项**：显示通用查询区域，标题显示对应菜单名称，并提供“查询”和“重置”按钮。
3. **查询结果展示**
    主内容区域以表格形式显示查询或统计结果。示例中采用模拟数据。
4. **默认加载**
    页面加载时自动显示【首页】查询区域与统计信息；点击【首页】菜单可返回首页视图。

### 4.2 已实现功能模块

- **左侧菜单功能**：菜单项点击事件、激活状态切换
- **顶部查询区域**：动态显示不同查询组合菜单
- **查询与重置按钮**：绑定点击事件，模拟查询操作（调用 `loadResults` 模拟加载数据）
- **主内容区域**：加载动画及平滑显示查询结果表格

### 4.3 源代码文件（部分示例）

#### 4.3.1 `data_entry.html`

```html
<!-- 文件：data_entry.html -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- 文件说明：用于录入学生数据，包括教育ID号、姓名、学校代码、左右眼视力等 -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>学生数据录入</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-4">
        <h2>学生数据录入</h2>
        <form id="entryForm">
            <div class="mb-3">
                <label for="full_edu_id" class="form-label">教育ID号</label>
                <input type="text" class="form-control" id="full_edu_id" name="full_edu_id" placeholder="请输入教育ID号" required>
            </div>
            <div class="mb-3">
                <label for="name" class="form-label">姓名</label>
                <input type="text" class="form-control" id="name" name="name" placeholder="请输入学生姓名" required>
            </div>
            <div class="mb-3">
                <label for="school_code" class="form-label">学校代码</label>
                <input type="text" class="form-control" id="school_code" name="school_code" placeholder="请输入学校代码" required>
            </div>
            <div class="mb-3">
                <label for="vision_left" class="form-label">左眼视力</label>
                <input type="number" step="0.1" class="form-control" id="vision_left" name="vision_left" placeholder="请输入左眼视力" required>
            </div>
            <div class="mb-3">
                <label for="vision_right" class="form-label">右眼视力</label>
                <input type="number" step="0.1" class="form-control" id="vision_right" name="vision_right" placeholder="请输入右眼视力" required>
            </div>
            <button type="submit" class="btn btn-primary">提交</button>
        </form>
        <div id="result" class="mt-3"></div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $("#entryForm").submit(function(event) {
            event.preventDefault();
            let formData = {
                full_edu_id: $("#full_edu_id").val(),
                name: $("#name").val(),
                school_code: $("#school_code").val(),
                vision_left: parseFloat($("#vision_left").val()),
                vision_right: parseFloat($("#vision_right").val())
            };
            $.ajax({
                url: "http://127.0.0.1:5000/api/student/add",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify(formData),
                success: function(response) {
                    $("#result").html("<div class='alert alert-success'>录入成功，ID：" + response.id + "</div>");
                },
                error: function(xhr) {
                    let errorMsg = "录入失败";
                    if (xhr.responseJSON && xhr.responseJSON.error) {
                        errorMsg += "：" + xhr.responseJSON.error;
                    }
                    $("#result").html("<div class='alert alert-danger'>" + errorMsg + "</div>");
                }
            });
        });
    </script>
</body>
</html>
```

#### 4.3.2 `app.py`

```python
# 文件：app.py
"""
app.py
功能说明：
1. 初始化 Flask 应用，加载配置文件（DevelopmentConfig）。
2. 初始化数据库并注册 API 蓝图（如 student_api、query_api）。
3. 定义根路由和静态文件路由（返回前端页面）。
4. 启动 Flask 开发服务器。
"""
import os
from flask import Flask, send_from_directory
from src.context_system.api.endpoints.student_api import student_api
from src.context_system.api.endpoints.query_api import query_api
from src.context_system.infrastructure.database import db
from config.app.config import DevelopmentConfig

app = Flask(__name__)
app.config.from_object(DevelopmentConfig)
print("SQLALCHEMY_DATABASE_URI:", app.config.get("SQLALCHEMY_DATABASE_URI"))
db.init_app(app)
app.register_blueprint(student_api)
app.register_blueprint(query_api)

@app.route('/')
def index():
    return "欢迎来到近视预防干预系统！"

@app.route('/data_entry.html')
def data_entry():
    directory = os.path.join(app.root_path, 'frontend', 'web')
    return send_from_directory(directory, 'data_entry.html')

@app.route('/data_query.html')
def data_query():
    directory = os.path.join(app.root_path, 'frontend', 'web')
    return send_from_directory(directory, 'data_query.html')

@app.route('/dashboard.html')
def dashboard():
    directory = os.path.join(app.root_path, 'frontend', 'web')
    return send_from_directory(directory, 'dashboard.html')

if __name__ == '__main__':
    app.run(debug=True)
```

#### 4.3.3 `student_api.py`

```python
# 文件：src/context_system/api/endpoints/student_api.py
"""
student_api.py
功能说明：
实现学生数据录入 API 接口：
1. 接收前端提交的 JSON 数据，校验必填字段。
2. 使用 SQLAlchemy 将数据存入数据库，出现错误时回滚事务。
"""
from flask import Blueprint, request, jsonify
from sqlalchemy.exc import SQLAlchemyError
from src.context_system.core.models.student import Student
from src.context_system.infrastructure.database import db

student_api = Blueprint('student_api', __name__)

@student_api.route('/api/student/add', methods=['POST'])
def add_student():
    data = request.get_json()
    if not data.get("full_edu_id") or not data.get("name") or not data.get("school_code") or \
       data.get("vision_left") is None or data.get("vision_right") is None:
        return jsonify({"error": "必填字段缺失"}), 400
    try:
        student = Student(
            full_edu_id=data["full_edu_id"],
            school_code=data["school_code"],
            name=data["name"],
            vision_left=data["vision_left"],
            vision_right=data["vision_right"],
            myopia_level=None
        )
        db.session.add(student)
        db.session.commit()
        return jsonify({"message": "录入成功", "id": student.id}), 201
    except SQLAlchemyError as e:
        db.session.rollback()
        return jsonify({"error": f"数据库错误: {str(e)}"}), 500
```

#### 4.3.4 `query_api.py`

```python
# 文件：src/context_system/api/endpoints/query_api.py
"""
query_api.py
功能说明：
实现学生数据查询 API 接口：
1. 支持按照学生姓名模糊查询。
2. 支持分页查询，返回当前页数据和总记录数，数据格式为 JSON。
"""
from flask import Blueprint, request, jsonify
from src.context_system.core.models.student import Student

query_api = Blueprint('query_api', __name__)

@query_api.route('/api/students/query', methods=['GET'])
def query_students():
    name = request.args.get("name", "")
    page = request.args.get("page", 1, type=int)
    per_page = request.args.get("per_page", 10, type=int)
    query = Student.query.filter(Student.name.ilike(f"%{name}%"))
    pagination = query.paginate(page=page, per_page=per_page, error_out=False)
    students = [student.to_dict() for student in pagination.items]
    return jsonify({
        "students": students,
        "total": pagination.total,
        "page": page,
        "per_page": per_page
    })
```

#### 4.3.5 Dashboard / 查询统计页面（今日工作）

```html
<!-- 文件：dashboard.html -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!--
        文件名称：dashboard.html
        功能说明：综合查询与统计分析界面。
                   包含左侧菜单（首页、基本信息、学校数量、班级数量、学生数量、视力数据、干预效果、干预次数）；
                   顶部区域根据所选菜单动态显示对应的查询组合菜单及“查询”和“重置”按钮；
                   主内容区域展示查询或统计结果（以表格形式）。
    -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>综合查询与统计分析</title>
    <!-- 引入 Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <!-- 引入 Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" 
          integrity="sha512-dC+N2VDZ+B0s++RknPp3p0T4/Ok2r/0ygkdb0A3Ol0Rj6ZnQc19gTx5ICV06r8JciBzFhTqLA/8Uu3VvA9wT5g==" 
          crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* 整体蓝白扁平化风格 */
        body {
            background-color: #f0f4f8;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        /* 顶部导航栏 */
        .navbar {
            background-color: #007bff;
            color: #fff;
        }
        .navbar-brand, .navbar-nav .nav-link {
            color: #fff !important;
        }
        /* 左侧菜单 */
        #sidebar {
            background-color: #fff;
            border-right: 1px solid #dee2e6;
            min-height: 100vh;
            transition: width 0.3s ease;
            width: 250px;
        }
        #sidebar.collapsed {
            width: 60px;
        }
        .menu-header {
            padding: 10px 15px;
            font-size: 1.1rem;
            font-weight: bold;
            border-bottom: 1px solid #dee2e6;
        }
        #sidebar .nav-link {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            color: #333;
            font-weight: 500;
            cursor: pointer;
        }
        #sidebar .nav-link.active, #sidebar .nav-link:hover {
            background-color: #e9f2ff;
            color: #007bff;
        }
        /* 本示例菜单中暂不使用图标，后续可添加 */
        /* 当折叠时隐藏文字和标题 */
        #sidebar.collapsed .menu-text,
        #sidebar.collapsed .menu-header {
            display: none;
        }
        /* 顶部查询区域 */
        #topQuery {
            background-color: #fff;
            border-bottom: 1px solid #dee2e6;
            padding: 10px 15px;
        }
        /* 主内容区域 */
        #resultsArea {
            background-color: #fff;
            padding: 20px;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-top: 15px;
        }
        /* 加载动画 */
        #loadingSpinner {
            display: none;
            text-align: center;
            padding: 50px;
        }
        /* 小屏幕设置 */
        @media (max-width: 768px) {
            #sidebar {
                position: fixed;
                top: 0;
                left: 0;
                width: 250px;
                height: 100%;
                z-index: 1050;
                transform: translateX(-250px);
                transition: transform 0.3s ease;
            }
            #sidebar.show {
                transform: translateX(0);
            }
            #sidebarToggleWrapper {
                display: block;
                background-color: #007bff;
                color: #fff;
                padding: 10px;
            }
        }
        @media (min-width: 769px) {
            #sidebarToggleWrapper {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- 顶部导航栏 -->
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">近视预防干预系统</a>
            <!-- 顶端查询区域 -->
            <div id="topQuery" class="ms-auto">
                <!-- 默认显示首页查询区域 -->
                <div id="queryPanel-home">
                    <h5>首页统计信息</h5>
                    <p>学校数量：<strong id="stat-schools">3</strong></p>
                    <p>学生数量：<strong id="stat-students">299</strong></p>
                    <p>性别比例：<strong id="stat-gender">男:女 = 55%:45%</strong></p>
                    <p>近视程度占比：<strong id="stat-myopia">低度:中度:高度 = 40%:35%:25%</strong></p>
                    <p>干预效果：<strong id="stat-interv">有效率 80%</strong></p>
                    <p>视力改善人数及比例：<strong id="stat-improve">50人 (16.7%)</strong></p>
                </div>
                <!-- 基本信息查询区域 -->
                <div id="queryPanel-basic" class="d-none">
                    <div class="row g-2 align-items-center">
                        <div class="col-auto">
                            <select class="form-select" id="q_school" title="请选择学校">
                                <option value="">学校</option>
                                <option value="001">苏宁红军小学校</option>
                                <option value="002">师大附小清华小学校</option>
                                <option value="003">华兴小学校</option>
                                <option value="all">全选</option>
                            </select>
                        </div>
                        <div class="col-auto">
                            <select class="form-select" id="q_grade" title="请选择年级">
                                <option value="">年级</option>
                                <option value="一年级">一年级</option>
                                <option value="二年级">二年级</option>
                                <option value="三年级">三年级</option>
                                <option value="all">全选</option>
                            </select>
                        </div>
                        <div class="col-auto">
                            <select class="form-select" id="q_class" title="请选择班级">
                                <option value="">班级</option>
                                <option value="1班">1班</option>
                                <option value="2班">2班</option>
                                <option value="3班">3班</option>
                                <option value="all">全选</option>
                            </select>
                        </div>
                        <div class="col-auto">
                            <select class="form-select" id="q_name" title="请选择姓名">
                                <option value="">姓名</option>
                                <option value="张三">张三</option>
                                <option value="李四">李四</option>
                                <option value="all">全选</option>
                            </select>
                        </div>
                        <div class="col-auto">
                            <select class="form-select" id="q_gender" title="请选择性别">
                                <option value="">性别</option>
                                <option value="男">男</option>
                                <option value="女">女</option>
                                <option value="all">全选</option>
                            </select>
                        </div>
                        <div class="col-auto">
                            <button class="btn btn-primary" type="button" id="btn-query">查询</button>
                        </div>
                        <div class="col-auto">
                            <button class="btn btn-secondary" type="button" id="btn-reset">重置</button>
                        </div>
                    </div>
                </div>
                <!-- 通用查询区域：用于其它菜单项 -->
                <div id="queryPanel-default" class="d-none">
                    <h5 id="defaultQueryTitle"></h5>
                    <p>此处显示对应菜单的查询组合菜单...</p>
                    <div class="d-flex">
                        <button class="btn btn-primary me-2" type="button" id="btn-query-default">查询</button>
                        <button class="btn btn-secondary" type="button" id="btn-reset-default">重置</button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- 小屏幕左侧菜单折叠按钮 -->
    <div id="sidebarToggleWrapper" class="d-md-none">
        <button class="btn btn-outline-light" id="sidebarToggle" title="切换菜单" aria-label="切换菜单">
            切换菜单
        </button>
    </div>

    <!-- 主页面布局 -->
    <div class="container-fluid mt-3">
        <div class="row">
            <!-- 左侧菜单 -->
            <nav id="sidebar" class="col-md-2 d-none d-md-block">
                <div class="position-sticky">
                    <!-- 大屏幕折叠按钮 -->
                    <div class="d-none d-md-block text-end mb-2">
                        <button class="btn btn-sm btn-outline-primary" id="sidebarToggleDesktop" title="折叠菜单" aria-label="折叠菜单">
                            切换
                        </button>
                    </div>
                    <!-- 菜单标题 -->
                    <h5 class="menu-header mb-3">菜单</h5>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" data-menu="home">
                                首页
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-menu="basic">
                                基本信息
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-menu="schoolCount">
                                学校数量
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-menu="classCount">
                                班级数量
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-menu="studentCount">
                                学生数量
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-menu="vision">
                                视力数据
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-menu="intervEffect">
                                干预效果
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-menu="intervTimes">
                                干预次数
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- 主内容区域 -->
            <main id="content" class="col-md-10 ms-sm-auto col-lg-10 px-md-4">
                <!-- 加载动画 -->
                <div id="loadingSpinner">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">加载中...</span>
                    </div>
                </div>
                <!-- 查询/统计结果显示区域 -->
                <div id="resultsArea">
                    <h3>查询/统计结果</h3>
                    <div id="resultsContent">
                        <p>请在上方选择查询条件或统计功能...</p>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- 引入 Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- 引入 jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // 页面初始化：默认显示首页查询区域及对应结果
        $(document).ready(function() {
            showQueryPanel("home");
            loadResults("home");
        });

        // 左侧菜单点击事件
        $("#sidebar a.nav-link").click(function(e) {
            e.preventDefault();
            $("#sidebar a.nav-link").removeClass("active");
            $(this).addClass("active");
            var menuType = $(this).data("menu");
            showQueryPanel(menuType);
            loadResults(menuType);
        });

        // 根据菜单类型显示顶部查询区域
        function showQueryPanel(menuType) {
            $("#queryPanel-home, #queryPanel-basic, #queryPanel-default").addClass("d-none");
            if(menuType === "home") {
                $("#queryPanel-home").removeClass("d-none");
            } else if(menuType === "basic") {
                $("#queryPanel-basic").removeClass("d-none");
            } else {
                $("#queryPanel-default").removeClass("d-none");
                $("#defaultQueryTitle").text(getMenuTitle(menuType) + "查询");
            }
        }

        // 根据菜单类型返回菜单标题
        function getMenuTitle(menuType) {
            var titles = {
                "schoolCount": "学校数量",
                "classCount": "班级数量",
                "studentCount": "学生数量",
                "vision": "视力数据",
                "intervEffect": "干预效果",
                "intervTimes": "干预次数"
            };
            return titles[menuType] || "";
        }

        // 模拟加载结果函数
        function loadResults(menuType) {
            $("#resultsContent").hide();
            $("#loadingSpinner").show();
            setTimeout(function() {
                var html = "<table class='table table-bordered'><tr><th>指标</th><th>数值</th></tr>";
                if(menuType === "home") {
                    html += "<tr><td>学校数量</td><td>3</td></tr>";
                    html += "<tr><td>学生数量</td><td>299</td></tr>";
                    html += "<tr><td>性别比例</td><td>男:女 = 55%:45%</td></tr>";
                    html += "<tr><td>近视程度占比</td><td>低度:中度:高度 = 40%:35%:25%</td></tr>";
                    html += "<tr><td>干预效果</td><td>有效率 80%</td></tr>";
                    html += "<tr><td>视力改善人数及比例</td><td>50人 (16.7%)</td></tr>";
                } else if(menuType === "basic") {
                    html += "<tr><th>教育ID号</th><th>学校</th><th>年级</th><th>班级</th><th>姓名</th><th>性别</th></tr>";
                    html += "<tr><td>1234</td><td>师大附小</td><td>三年级</td><td>1班</td><td>张三</td><td>男</td></tr>";
                    html += "<tr><td>5678</td><td>苏宁红军小学校</td><td>二年级</td><td>2班</td><td>李四</td><td>女</td></tr>";
                } else {
                    html += "<tr><td colspan='2'>显示 " + getMenuTitle(menuType) + " 统计信息（待开发）</td></tr>";
                }
                html += "</table>";
                $("#resultsContent").html(html).fadeIn();
                $("#loadingSpinner").hide();
            }, 1000);
        }

        // 顶部【基本信息】查询面板：查询和重置按钮事件
        $("#btn-query").click(function() {
            loadResults("basic");
        });
        $("#btn-reset").click(function() {
            $("#q_school, #q_grade, #q_class, #q_name, #q_gender").val("");
            loadResults("basic");
        });
        // 顶部通用查询面板事件
        $("#btn-query-default").click(function() {
            loadResults($("#sidebar a.nav-link.active").data("menu"));
        });
        $("#btn-reset-default").click(function() {
            alert("重置查询条件（待实现）");
        });
        // 小屏幕折叠按钮事件
        $("#sidebarToggle").click(function() {
            $("#sidebar").toggleClass("show");
        });
        // 大屏幕折叠按钮事件
        $("#sidebarToggleDesktop").click(function() {
            $("#sidebar").toggleClass("collapsed");
        });
    </script>
</body>
</html>
```

------

## 五、 总结

1. **项目初始化与环境配置**
   - 已创建项目根目录及全局、运行时子目录。
   - 配置并安装了 Python（3.10.10、3.12.8）、VSCode、pyenv；建立了 `.venv` 虚拟环境；安装所需依赖库。
2. **后端开发**
   - 编写了配置文件、应用初始化代码（`app.py`），数据库初始化脚本（`init_db.py`）。
   - 实现了学生数据录入 API（`student_api.py`）和数据查询 API（`query_api.py`）。
3. **前端开发**
   - 实现了数据录入页面（`data_entry.html`）与数据查询页面（`data_query.html`）。
   - 单元测试均已通过（参见 `tests/` 下相关测试用例）。
4. **今天工作内容**
   - 开发并调试了 Dashboard（或 Query Statistics）页面，包含左侧菜单、顶部动态查询区域、主内容区查询结果展示及加载动画。
   - 左侧菜单共包含“首页”、“基本信息”、“学校数量”、“班级数量”、“学生数量”、“视力数据”、“干预效果”、“干预次数”8项；点击菜单时顶部区域动态显示对应的查询组合菜单（“首页”显示统计信息；“基本信息”显示查询下拉菜单；其它显示通用提示）。
   - 查询区域中增加“查询”和“重置”按钮，并模拟加载数据后以表格形式展示结果。
5. **后续工作规划**
   - 后续将进一步完善各菜单项的具体查询内容、动态数据获取、电子表格和 PDF 导出功能，以及侧边菜单图标优化等功能。

------

以上为项目到目前为止完成的全部工作及详细技术总结，包含了所有确认的源代码、技术架构信息及完成的模块信息。后续开发工作将基于此完整上下文继续进行。