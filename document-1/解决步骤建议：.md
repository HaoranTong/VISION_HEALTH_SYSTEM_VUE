为了确保解决问题时有条不紊，建议我们**分步骤逐一解决**，每次解决一个具体问题，确保不引入新的问题，并能更清晰地测试每个功能。

### 解决步骤建议：

1. **表头合并问题**
    这是当前最大的核心问题之一，需要先确保表头的合并逻辑能够正确执行。在动态生成表头时，特别是在自由组合查询的情况下，表头合并需要根据用户选择的统计指标和分组动态调整。
    **解决方法**：
   - 确保前端根据用户选择的指标和分组，动态生成对应的表头结构。
   - 解决合并单元格时，确保每一列对应的子选项正确展示。
2. **计算和统计数据动态更新**
    在当前的报表中，选择的统计指标数据没有根据选择进行动态计算。我们需要确保表格内容和计算数据在选择不同的指标时，能够动态变化，而不是固定内容。 **解决方法**：
   - 后端需要根据传递的查询条件计算对应的统计数据，前端根据返回的数据渲染表格。
   - 确保在计算时动态获取选择的统计字段，避免固定“临床前期近视”等固定的字段。
3. **合计行数据计算**
    确保合计行中的“数量”和“占比”数据是正确的，特别是占比列。占比列应该是基于当前查询条件下的总数占比。 **解决方法**：
   - 对每列进行合计，并计算占比，即合计数量/总数量。
4. **修改表格显示和数据字段匹配**
    确保表格内容能够匹配实际的查询条件，不会因为统计指标的选择而错乱或出现空列。 **解决方法**：
   - 确保前端根据后端返回的数据，动态更新表格列数，避免展示多余的列或空白列。

### 我建议按上述步骤逐一解决，首先解决表头合并问题，确保基础结构正确，再逐步处理动态数据计算和合计数据等功能，避免一次性修改过多地方导致问题难以定位。每解决一个问题后都要进行严格测试，确保功能不会互相影响。